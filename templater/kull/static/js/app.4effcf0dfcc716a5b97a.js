webpackJsonp([1],Array(28).concat([function(e,t,n){"use strict";var o=n(16),i=n(92),r=n(81),s=n.n(r);o.a.use(i.a),t.a=new i.a({routes:[{path:"/",name:"Editor",component:s.a}]})},function(e,t,n){function o(e){n(72)}var i=n(0)(n(31),n(89),o,null,null);e.exports=i.exports},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(16),i=n(29),r=n.n(i),s=n(28);o.a.config.productionTip=!1,new o.a({el:"#app",router:s.a,template:"<App/>",components:{App:r.a}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(80),i=n.n(o),r=n(82),s=n.n(r);t.default={name:"Annotator",components:{AreaSelect:i.a,SelectionPreview:s.a},props:["src","name","selections","addSelection","arrayBuffer","setSize"],data:function(){return{down:!1,coords:{xa:null,ya:null,xb:null,yb:null},pageNumber:1,pageOffset:{top:0,left:0}}},computed:{coordinates:function(){return{left:Math.min(this.coords.xa,this.coords.xb),top:Math.min(this.coords.ya,this.coords.yb),width:Math.abs(this.coords.xa-this.coords.xb),height:Math.abs(this.coords.ya-this.coords.yb),page:this.pageNumber,pageOffset:{top:this.pageOffset.top,left:this.pageOffset.left}}}},methods:{reset:function(){this.coords.xa=null,this.coords.ya=null,this.coords.xb=null,this.coords.yb=null},start:function(e){this.down=!0,this.pageNumber=parseInt(e.target.getAttribute("data-page-number")||1),this.pageOffset.top=e.target.offsetTop,this.pageOffset.left=e.target.offsetLeft,this.coords.xa=e.offsetX,this.coords.ya=e.offsetY,this.coords.xb=e.offsetX,this.coords.yb=e.offsetY},end:function(e){e.stopPropagation(),e.preventDefault(),this.down=!1,this.addSelection(this.coordinates),this.reset()},drag:function(e){e.stopPropagation(),e.preventDefault(),this.down&&(this.coords.xb=e.offsetX,this.coords.yb=e.offsetY)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"area-select",props:["coordinates","color","name","active"],computed:{styleObject:function(){return 0===this.height||0===this.width?{display:"none"}:{left:this.coordinates.left+this.coordinates.pageOffset.left+"px",top:this.coordinates.top+this.coordinates.pageOffset.top+"px",width:this.coordinates.width+"px",height:this.coordinates.height+"px",border:"solid "+this.color+" 1px",background:this.color.replace(/\)$/,", 0.05)").replace("rgb(","rgba(")}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(83),i=n.n(o),r=n(79),s=n.n(r),a=n(84),c=n.n(a),l=n(76),f=n.n(l);t.default={name:"editor",components:{Uploader:i.a,Annotator:s.a,ZoneViewer:c.a},data:function(){return{src:null,name:"",selections:[],dimensions:{height:0,width:0}}},methods:{batchUpdateSelections:function(e){this.selections=e},setSize:function(e,t){this.dimensions={width:e,height:t}},addSelection:function(e){0!==e.height&&0!==e.width&&this.selections.push({id:+new Date,coordinates:{top:e.top,left:e.left,height:e.height,width:e.width,page:e.page,pageOffset:e.pageOffset},color:f()({format:"rgb"}),name:"Unnamed"+this.selections.length})},newFile:function(e){this.src=e.src,this.name=e.name,this.selections=[]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n.n(o);t.default={props:["coordinates"],data:function(){return{text:null}},computed:{},watch:{coordinates:function(){this.highlightOverlaps()}},methods:{hasCoordinates:function(){var e=this.coordinates;return!!(e&&e.top&&e.left&&0!==e.height&&0!==e.width)},overlapping:function(){if(this.hasCoordinates()){var e=document.querySelectorAll('.page[data-page-number="1"] .textLayer div');return Array.prototype.filter.call(e,this._overlaps)}return[]},overlappingText:function(){return this.overlapping().map(function(e){return e.textContent}).join(" ")},highlightOverlaps:function(){this.unhighlight(),this.overlapping().forEach(this._highlight)},_highlight:function(e){-1===e.className.indexOf("selected-preview")&&(e.className+=" selected-preview")},unhighlight:function(e){var t=document.querySelectorAll(".selected-preview"),n=!0,o=!1,r=void 0;try{for(var s,a=i()(t);!(n=(s=a.next()).done);n=!0){var c=s.value;c.className=c.className.replace("selected-preview","")}}catch(e){o=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}},_overlaps:function(e){var t=this.coordinates;return!(e.offsetLeft>t.left+t.width||e.offsetLeft+e.offsetWidth<t.left)&&!(e.offsetTop>t.top+t.height||t.top>e.offsetTop+e.offsetHeight)},_sorted:function(e,t){return e.offsetTop===t.offsetTop?e.offsetLeft<t.offsetTop?-1:1:e.offsetTop<t.offsetTop?-1:1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{notify:{type:Function,require:!0}},data:function(){return{name:null}},methods:{processReaderImage:function(e){this.notify({name:this.name,src:e.target.result})},getFile:function(e){var t=e[0];if(this.name=t.name,t.type.match("image.*")){var n=new FileReader;n.addEventListener("load",this.processReaderImage,!1),n.readAsDataURL(t)}else alert("Not an image file")},selected:function(e){this.getFile(e.target.files)},drop:function(e){e.stopPropagation(),e.preventDefault(),this.getFile(e.dataTransfer.files)},dragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n.n(o),r=n(38),s=n.n(r);t.default={name:"zone-viewer",props:["selections","batchUpdateSelections","originalFilename","image"],data:function(){return{uzn:null,editing:!1}},computed:{filename:function(){return this.originalFilename.replace(/(.*)\..*/,"$1")}},mounted:function(){this.redrawUzn()},watch:{selections:function(){this.redrawUzn()}},methods:{upload:function(){var e={};e.template=this.image,e.metadata=[];var t=!0,n=!1,o=void 0;try{for(var r,a=i()(this.uzn.split("\n"));!(t=(r=a.next()).done);t=!0){var c=r.value,l=/([0-9]+) ([0-9]+) ([0-9]+) ([0-9]+) (.*)/.exec(c);e.metadata.push({x1:l[1],y1:l[2],x2:l[3],y2:l[4],name:l[5]})}}catch(e){n=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw o}}fetch("/models/"+this.filename,{method:"POST",headers:{"Content-Type":"application/json"},body:s()(e)})},startEditing:function(){this.editing=!0},stopEditing:function(){this.editing=!1,this.redrawUzn()},redrawUzn:function(){if(!this.editing){var e=this.selections.map(function(e){return e.coordinates.left+" "+e.coordinates.top+" "+e.coordinates.width+" "+e.coordinates.height+" "+e.name});this.uzn=e.join("\n")}},changed:function(e){var t=this,n=this.uzn.split("\n").map(function(e,n){try{var o=e.match(/(\d+) (\d+) (\d+) (\d+) (.*)/),i=t.selections[n];return i.coordinates.left=parseInt(o[1]),i.coordinates.top=parseInt(o[2]),i.coordinates.width=parseInt(o[3]),i.coordinates.height=parseInt(o[4]),i.name=o[5],i}catch(e){return null}}).filter(function(e){return null!=e});console.log("updating with",n),this.batchUpdateSelections(n)}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,function(e,t,n){function o(e){n(68)}var i=n(0)(n(32),n(85),o,"data-v-1012eace",null);e.exports=i.exports},function(e,t,n){function o(e){n(71)}var i=n(0)(n(33),n(88),o,"data-v-764c7b08",null);e.exports=i.exports},function(e,t,n){function o(e){n(70)}var i=n(0)(n(34),n(87),o,null,null);e.exports=i.exports},function(e,t,n){function o(e){n(69)}var i=n(0)(n(35),n(86),o,null,null);e.exports=i.exports},function(e,t,n){function o(e){n(74)}var i=n(0)(n(36),n(91),o,"data-v-ed86357e",null);e.exports=i.exports},function(e,t,n){function o(e){n(73)}var i=n(0)(n(37),n(90),o,null,null);e.exports=i.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.name?n("h3",[e._v("\n    Currently working on: "),n("span",{staticClass:"filename"},[e._v(e._s(e.name))]),e._v(" "),n("span",{staticClass:"filetype"},[e._v("image")])]):e._e(),e._v(" "),e.src||e.arrayBuffer?n("div",{ref:"selectionArea",staticClass:"selection-area",on:{mousedown:e.start,mouseup:e.end,mousemove:e.drag}},[e.src?n("img",{attrs:{src:e.src}}):e._e(),e._v(" "),e.arrayBuffer?n("SelectionPreview",{attrs:{coordinates:e.coordinates}}):e._e(),e._v(" "),n("AreaSelect",{ref:"activeSelector",attrs:{coordinates:e.coordinates,color:"rgb(0,255,0)",active:"true"}}),e._v(" "),e._l(e.selections,function(e){return n("AreaSelect",{key:e.id,attrs:{color:e.color,coordinates:e.coordinates,name:e.name}})})],2):e._e()])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"preview"},[e._v("\n"+e._s(e.text)+"\n")])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor"},[n("div",{staticClass:"sidebar"},[n("h1",[e._v("Reyah Template Creator")]),e._v(" "),n("Uploader",{attrs:{notify:e.newFile}}),e._v(" "),e.name?n("p",[n("strong",[e._v("Click and drag on the image to the right")]),e._v(" to form selection areas.")]):e._e(),e._v(" "),n("ZoneViewer",{ref:"viewer",staticClass:"zone-viewer",attrs:{image:e.src,selections:e.selections,batchUpdateSelections:e.batchUpdateSelections,originalFilename:e.name}})],1),e._v(" "),n("div",{staticClass:"content"},[n("Annotator",{attrs:{src:e.src,setSize:e.setSize,name:e.name,selections:e.selections,addSelection:e.addSelection}})],1)])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"selection-box",style:e.styleObject},[n("span",[e._v(e._s(e.name))])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.selections.length>0?n("div",{staticClass:"zone-viewer"},[n("h2",[e._v("Your zone file")]),e._v(" "),e._m(0),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.uzn,expression:"uzn"}],ref:"textarea",domProps:{value:e.uzn},on:{keyup:e.changed,blur:e.stopEditing,focus:e.startEditing,input:function(t){t.target.composing||(e.uzn=t.target.value)}}}),e._v(" "),n("button",{on:{click:e.upload}},[e._v("Upload template file")])]):e._e()},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("strong",[e._v("Edit the code below")]),e._v(" and it'll update on the right!")])}]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"dragover"},on:{dragover:e.dragover,drop:e.drop}},[n("h3",[e._v("Drag & drop your file here")]),e._v(" "),e._m(0),e._v(" "),n("p",[e._v("accepts images")]),e._v(" "),n("input",{attrs:{type:"file",id:"file",name:"file"},on:{change:e.selected}})])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("or "),n("label",{attrs:{for:"file"}},[e._v("click to browse")])])}]}}]),[30]);
//# sourceMappingURL=app.4effcf0dfcc716a5b97a.js.map